#!/usr/bin/env groovy

def label = "example-pipeline-${UUID.randomUUID().toString()}"

podTemplate(label: label,
        containers: [
                containerTemplate(name: 'jnlp', image: 'jenkins/inbound-agent:latest'),
        ],
        ) {
    node(label) {
        stage('Init') {
            timeout(time: 3, unit: 'MINUTES') {
                checkout scm
            }
        }
        stage('Dep') {
            echo 'Hello from Dep stage'
            echo 'Helo from Dep stage aka build docker image'
        }
        stage('Test') {
            echo 'Hello from Test stage'
        }
        stage('Build') {
            echo 'Hello from Build stage'
        }
        stage('Docker Build') {
    	    agent any
            steps {
      	            sh 'docker build -t shanem/spring-petclinic:latest .'
            }
        }
    }
}